---
in: |
  deployments:
    blockscout-postgres-{{ .Env.ETHEREUM_VARIANT }}-chain-{{ .Env.CHAIN_NAME }}-{{ .Env.CHAIN_ID }}:
      namespace: ${NAMESPACE}
      helm:
        displayOutput: true
        chart:
          name: oci://registry-1.docker.io/bitnamicharts/postgresql
          version: 16.4.7
        values:
          fullnameOverride: blockscout-postgres-{{ .Env.ETHEREUM_VARIANT }}-chain-{{ .Env.CHAIN_NAME }}-{{ .Env.CHAIN_ID }}
        valuesFiles:
          - ./values/postgres.yaml

    blockscout-{{ .Env.ETHEREUM_VARIANT }}-chain-{{ .Env.CHAIN_NAME }}-{{ .Env.CHAIN_ID }}:
      namespace: ${NAMESPACE}
      helm:
        displayOutput: true
        chart:
          repo: https://blockscout.github.io/helm-charts
          name: blockscout-stack
          version: 2.0.0
        values:
          fullnameOverride: blockscout-{{ .Env.ETHEREUM_VARIANT }}-chain-{{ .Env.CHAIN_NAME }}-{{ .Env.CHAIN_ID }}
          config:
            testnet: true
            network:
              id: {{ .Env.CHAIN_ID }}
              name: {{ .Env.ETHEREUM_VARIANT }}
              shortname: {{ .Env.ETHEREUM_VARIANT }}
            prometheus:
              enabled: false
              blackbox:
                enabled: false
          blockscout:
            enabled: true
            image:
              pullPolicy: Always
              tag: ${BLOCKSCOUT_IMAGE_TAG}
            env:
              DATABASE_URL: 'postgresql://blockscout:blockscout123@blockscout-postgres-{{ .Env.ETHEREUM_VARIANT }}-chain-{{ .Env.CHAIN_NAME }}-{{ .Env.CHAIN_ID }}.${NAMESPACE}.svc.cluster.local:5432/blockscout?ssl=false'
              ETHEREUM_JSONRPC_VARIANT: {{ .Env.ETHEREUM_VARIANT }}
              ETHEREUM_JSONRPC_HTTP_URL: 'http://{{ .Env.ETHEREUM_VARIANT }}-node-rpc-1.${NAMESPACE}.svc.cluster.local:8545'
              ETHEREUM_JSONRPC_TRACE_URL: 'http://{{ .Env.ETHEREUM_VARIANT }}-node-rpc-1.${NAMESPACE}.svc.cluster.local:8545'
              ECTO_USE_SSL: 'false'
              CHECK_ORIGIN: 'false'
            service:
              type: NodePort
            ingress:
              enabled: true
              hostname: ${NAMESPACE}-blockscout-backend.${DEVSPACE_INGRESS_BASE_DOMAIN}
            resources:
              limits:
                memory: '2Gi'
                cpu: '3000m'
              requests:
                memory: '1Gi'
                cpu: '1000m'
          frontend:
            enabled: true
            replicaCount: 1
            resources:
              limits:
                memory: '2Gi'
                cpu: '2000m'
              requests:
                memory: '512Mi'
                cpu: '1000m'
            ingress:
              enabled: true
              hostname: ${NAMESPACE}-blockscout.${DEVSPACE_INGRESS_BASE_DOMAIN}
            env:
              NEXT_PUBLIC_API_PORT: 443
              NEXT_PUBLIC_API_PROTOCOL: https
              NEXT_PUBLIC_VISUALIZE_API_HOST: http://localhost:8081
              NEXT_PUBLIC_APP_PORT: 443
              NEXT_PUBLIC_API_WEBSOCKET_PROTOCOL: 'wss'
              NEXT_PUBLIC_HOMEPAGE_CHARTS: '["daily_txs", "coin_price","market_cap", "tvl"]'
          stats:
            enabled: false
            ingress:
              enabled: false
