---
in: |
  pullSecrets:
    regcred-sdlc:
      registry: 795953128386.dkr.ecr.us-west-2.amazonaws.com
      secret: regcred-sdlc
  deployments:
    chainlink-don:
      helm:
        values:
          common:
            imagePullSecrets:
              - name: regcred-sdlc
            ingress:
              enabled: true
              ingressClassName: nginx
              annotations:
                nginx.ingress.kubernetes.io/use-regex: "true"
                # cert-manager.io/cluster-issuer: mkcert-issuer
                # nginx.ingress.kubernetes.io/ssl-redirect: "true"
                # todo: setup tls, currently this not possible via existing values, tls hostnames are not pro
                # processed the same way as in hosts
                # tls:
                #   - secretName: chainlink-node-tls
                #     hosts:
                #       - host: "${DEVSPACE_NAMESPACE}-%s.${DEVSPACE_INGRESS_BASE_DOMAIN}"
              hosts:
                - host: "${DEVSPACE_NAMESPACE}-%s.${DEVSPACE_INGRESS_BASE_DOMAIN}"
                  paths:
                    - path: /
                      pathType: Prefix
                  useNodeName: true
            ingressMock:
              enabled: true
              ingressClassName: nginx
              annotations:
                nginx.ingress.kubernetes.io/use-regex: "true"
                cert-manager.io/cluster-issuer: mkcert-issuer
                nginx.ingress.kubernetes.io/ssl-redirect: "true"
                nginx.ingress.kubernetes.io/backend-protocol: "GRPC"
              hosts:
                - host: "${DEVSPACE_NAMESPACE}-%s.${DEVSPACE_INGRESS_BASE_DOMAIN}"
                  paths:
                    - path: /
                      pathType: Prefix
                  useNodeName: true
              tls:
                - secretName: chainlink-node-tls
                  hosts:
                    - "${DEVSPACE_NAMESPACE}-mock-test.${DEVSPACE_INGRESS_BASE_DOMAIN}"
    {{- if eq (getenv "DON_TYPE") "gateway" }}
    gateway-ingress:
      helm:
        releaseName: gateway-ingress
        displayOutput: true
        chart:
          name: ${CHAINLINK_HELM_REGISTRY_URI}/chainlink-gateway-ingress
          version: "0.4.2"
        values:
          ingressClassName: "nginx"
          annotations:
            nginx.ingress.kubernetes.io/use-regex: "true"
            cert-manager.io/cluster-issuer: mkcert-issuer
            nginx.ingress.kubernetes.io/ssl-redirect: "true"
          ingressPathType: "Prefix"
          nodeMapping:
            - "0"
    {{- end }}
