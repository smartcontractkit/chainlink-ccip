version: v2beta1

vars:
  # "The provider being used to deploy CRIB"
  PROVIDER:
    source: all
    default: "aws"

dependencies:
  grafana:
    path: ${DEPENDENCIES_DIR}/grafana
    namespace: ${DEVSPACE_NAMESPACE}
    overwriteVars: true
    profiles:
      - kind
  loki:
    path: ${DEPENDENCIES_DIR}/loki
    namespace: ${DEVSPACE_NAMESPACE}
    overwriteVars: true
    profiles:
      - kind
  promtail:
    path: ${DEPENDENCIES_DIR}/promtail
    namespace: ${DEVSPACE_NAMESPACE}
    overwriteVars: true
    profiles:
      - default

commands:
  purge-kind:
    command: |-
      if [[ ${PROVIDER} == "kind" ]]; then
        ${SCRIPTS_DIR}/manage_kind.sh purge
      else
        echo "This command should be executed only when using Kind provider locally"
      fi
    description: Purge the local Kind cluster.
